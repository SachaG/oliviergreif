---
import Oeuvre from "../../components/catalogue/oeuvre/Oeuvre.compact.astro";
import { getCatalogue, getItemsByYear, pluralize, uniq } from "../../helpers";
import Layout from "../../layouts/Layout.astro";
import Instruments from "../../components/catalogue/Instruments.astro";
import SubgridLayout from "../../components/layouts/SubgridLayout.astro";
import GridLayout from "../../components/layouts/GridLayout.astro";
import MainLayout from "../../components/layouts/MainLayout.astro";
import type { OeuvreWithId } from "../../types";

const catalogue = getCatalogue();
const catalogueByYear = getItemsByYear<OeuvreWithId>(catalogue);
---

<Layout title="Catalogue">
	<MainLayout>
		<span slot="heading">
			<h2>
				Catalogue ({catalogue.length}
				{pluralize("oeuvre", catalogue.length)})
			</h2>
		</span>
		<GridLayout slot="content">
			<main slot="main">
				{
					catalogueByYear.map(({ year, items }) => {
						return (
							<SubgridLayout>
								<h4 class="year-title" slot="col1">
									<span>{year}</span>
								</h4>
								<div class="feed-items" slot="main">
									{items.map((oeuvre) => (
										<Oeuvre id={oeuvre.id} />
									))}
								</div>
							</SubgridLayout>
						);
					})
				}
			</main>
			<section class="sidebar" slot="sidebar">
				<div class="sidebar-contents">
					<Instruments />
				</div>
			</section>
		</GridLayout>
	</MainLayout>
</Layout>
